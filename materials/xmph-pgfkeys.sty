\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{xmph}[2021/11/22 v1.0 Extended emph]

\RequirePackage{color,pgfkeys,pgfopts}

\newif\ifxmph@useitalic
\newif\ifxmph@usebold
\newif\ifxmph@usecolour

\pgfkeys{
  /xmph/.cd,
  useitalic/.is if = xmph@useitalic,
  usebold/.is if = xmph@usebold,
  usecolour/.is if = xmph@usecolour,
  usecolor/.is if = xmph@usecolour,
  useitalic/.default = true,
  usebold/.default = true,
  usecolour/.default = true,
  usecolor/.style = {usecolour=#1},
  colour/.store in = \xmph@colour,
  color/.style = {colour=#1},
  inactive/.code = {%
    \PackageInfo{xmph}{Package inactive}
    \let\xmph\emph
  }
}

\pgfkeys{
  /xmph/.cd,
  useitalic,
  colour = red
}

\ProcessPgfOptions*

\newcommand*{\xmphsetup}{\pgfqkeys{/xmph}}

\AtBeginDocument{
  \pgfkeys{
    /xmph/inactive/.code = {%
      \PackageInfo{xmph}{%
        Option `inactive' only avaiable in preamble
      }%
    }
  }
}

% User macros
\providecommand*{\xmph}[1]{%
  \xmph@emph{\xmph@bold{%
    {\xmph@colourtext{#1}}}}%
}
\newcommand*{\xmph@emph}{%
  \ifxmph@useitalic\expandafter\emph
  \else\expandafter\@firstofone
  \fi%
}
\newcommand*{\xmph@bold}{%
  \ifxmph@usebold\expandafter\textbf
  \else\expandafter\@firstofone
  \fi%
}
\newcommand*{\xmph@colourtext}{%
  \ifxmph@usecolour\expandafter\textcolor
  \else\expandafter\@secondoftwo
  \fi
  {\xmph@colour}%
}
